<!--pages/index.wxml-->
<view class="page">
  <!-- 导航栏 -->
  <nav-bar 
    bind:settingchange="handleSettingChange"
  />
  
  <view class="container">
    <!-- 汤面显示区域 - 保持可见性，让dialog透明时能看到 -->
    <soup-display
      id="soupDisplay"
      soupId="{{soupConfig.soupId}}"
      autoPlay="{{soupConfig.autoPlay}}"
      staticMode="{{soupConfig.staticMode}}"
      bind:animationComplete="onSoupAnimationComplete"
      bind:loadFail="onSoupLoadFail"
      class="soup-display-component {{showDialog ? 'behind-dialog' : ''}} {{showDialog && isPeeking ? 'is-peeking' : ''}}"
      wx:if="{{!isCorrect && !showTruth}}"
    ></soup-display>
    
    <!-- 汤底显示区域 -->
    <soup-truth
      id="soupTruth"
      soupId="{{truthSoupId}}"
      wx:if="{{isCorrect || showTruth}}"
    ></soup-truth>
    
    <!-- 设置卡片 -->
    <setting-card
      show="{{showSetting}}"
      bind:switchchange="handleSettingChange"
      bind:close="onSettingClose"
    ></setting-card>
    
    <!-- 按钮区域 -->
    <view class="button-container {{showButtons ? 'show-buttons' : ''}}">
      <custom-button 
        type="light" 
        text="{{(isCorrect || showTruth) ? '分享汤面' : '开始喝汤'}}" 
        width="50%"
        height="80rpx"
        bind:tap="onStartSoup" 
        class="start-button"
        show="{{showButtons}}">
      </custom-button>
      <custom-button 
        type="unlight" 
        text="下一个" 
        width="50%"
        height="80rpx"
        bind:tap="onNextSoup" 
        class="next-button"
        show="{{showButtons}}">
      </custom-button>
    </view>
  </view>
  
  <!-- 对话组件 -->
  <dialog-component
    id="dialogComponent"
    visible="{{showDialog}}"
    soupId="{{dialogSoupId}}"
    bind:close="onDialogClose"
    bind:showTruth="onShowTruth"
    bind:peekSoup="onPeekSoup"
  ></dialog-component>
</view>