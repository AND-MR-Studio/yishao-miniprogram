<!--pages/index.wxml-->
<view class="page">
  <!-- 导航栏 -->
  <nav-bar
    bind:settingchange="handleSettingChange"
  />

  <view class="container">
    <!-- 汤面显示区域 -->
    <soup-display
      id="soupDisplay"
      soupId="{{currentSoupId}}"
      isPeeking="{{isPeeking}}"
      class="soup-display-component {{pageState === 'drinking' ? 'behind-dialog' : ''}} {{pageState === 'drinking' && isPeeking ? 'is-peeking' : ''}}"
      wx:if="{{pageState === 'viewing' || pageState === 'drinking'}}"
    ></soup-display>

    <!-- 汤底显示区域 -->
    <soup-truth
      id="soupTruth"
      soupId="{{currentSoupId}}"
      wx:if="{{pageState === 'truth'}}"
    ></soup-truth>

    <!-- 设置卡片 -->
    <setting-card
      show="{{showSetting}}"
      bind:switchchange="handleSettingChange"
      bind:close="onSettingClose"
    ></setting-card>

    <!-- 按钮区域 -->
    <view class="button-container {{showButtons ? 'show-buttons' : ''}}">
      <custom-button
        type="light"
        text="开始喝汤"
        width="50%"
        height="80rpx"
        bind:tap="onStartSoup"
        class="start-button"
        wx:if="{{showButtons}}">
      </custom-button>
      <custom-button
        type="unlight"
        text="下一个"
        width="50%"
        height="80rpx"
        bind:tap="onNextSoup"
        class="next-button"
        wx:if="{{showButtons}}">
      </custom-button>
    </view>
  </view>

  <!-- 对话组件 -->
  <dialog-component
    id="dialog"
    visible="{{pageState === 'drinking'}}"
    soupId="{{currentSoupId}}"
    bind:close="onDialogClose"
    bind:showTruth="onShowTruth"
    bind:peekSoup="onPeekSoup"
    bind:messageStatusChange="onMessageStatusChange"
  ></dialog-component>

  <!-- 输入栏组件已移至dialog组件内部 -->
</view>