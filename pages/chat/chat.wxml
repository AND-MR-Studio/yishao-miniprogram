<!--pages/chat/chat.wxml - æµ·é¾Ÿæ±¤èŠå¤©é¡µé¢-->
<view class="page">
  <!-- å¯¼èˆªæ  -->
  <nav-bar
    pageState="{{'drinking'}}"
    bind:settingchange="handleSettingChange"
    bind:close="onDialogClose"
    bind:clearcontext="clearContext"
    showBackButton="{{true}}"
  />

  <view class="container">
    <!-- æ±¤é¢æ˜¾ç¤ºåŒºåŸŸ - ç”¨äºŽå·çœ‹åŠŸèƒ½ -->
    <view class="soup-display-wrapper">
      <soup-display
        id="soupDisplay"
        soupData="{{soupData}}"
        loading="{{isLoading}}"
        isDrinking="{{true}}"
        isPeeking="{{isPeeking}}"
        class="soup-display-component {{isPeeking ? 'peeking' : ''}}"
        bind:longPressStart="onLongPressStart"
        bind:longPressEnd="onLongPressEnd"
      ></soup-display>
    </view>

    <!-- æ±¤åº•æ˜¾ç¤ºåŒºåŸŸ -->
    <soup-truth
      id="soupTruth"
      soupId="{{truthSoupId || ''}}"
      wx:if="{{isTruth}}"
    ></soup-truth>
  </view>

  <!-- å¯¹è¯ç»„ä»¶ -->
  <dialog-component
    id="dialog"
    visible="{{true}}"
    isPeeking="{{isPeeking}}"
    bind:close="onDialogClose"
    bind:showTruth="onShowTruth"
    bind:clearcontext="clearContext"
    bind:peekingStatusChange="handlePeekingStatusChange"
  ></dialog-component>

  <!-- è¾“å…¥æ ç»„ä»¶ -->
  <input-bar
    id="inputBar"
    inputValue="{{inputValue}}"
    disabled="{{isAnimating || isSending}}"
    sending="{{isSending}}"
    showTestButton="{{true}}"
    bind:input="handleInputChange"
    bind:send="handleSend"
    bind:testAgent="handleTestAgent"
    bind:voiceStart="handleVoiceStart"
    bind:voiceEnd="handleVoiceEnd"
    bind:voiceCancel="handleVoiceCancel"
  />

  <!-- æç¤ºæ¨¡å—ç»„ä»¶ -->
  <tip-module
    visible="{{shouldShowTip}}"
    bind:close="onTipModuleClose"
    bind:visibleChange="onTipVisibleChange"
    pageState="{{chatState || 'drinking'}}"
    tipTitle="æ±¤æ¥äº†ï¼æˆ‘æ˜¯é™ªä½ ç†¬å¤œçŒœè°œçš„å°å‹ºðŸŒ™"
    tipContent="{{['åªç­”æ˜¯ã€å¦ã€ä¸ç¡®å®šï¼Œåˆ«æƒ³å¥—æˆ‘è¯å“¦ï½ž', 'é•¿æŒ‰æ±¤é¢å°±æµ®å‡ºæ¥å’¯ï¼']}}"
  ></tip-module>
</view>